<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Code of Life - A DNA Journey</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0c0a1a; /* Dark purple background */
            color: white;
            overflow-x: hidden;
        }
        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            outline: none;
            z-index: 1;
        }
        .content-section {
            min-height: 120vh; /* Increased height for better spacing */
            display: flex;
            align-items: center;
            padding: 2rem;
            position: relative;
            z-index: 2;
        }
        .content-section:nth-child(odd) {
            justify-content: flex-start;
        }
        .content-section:nth-child(even) {
            justify-content: flex-end;
        }
        .info-card {
            max-width: 450px;
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid #374151;
            padding: 2rem;
            border-radius: 1rem;
            opacity: 0; /* Animate with GSAP */
            transform: translateY(20px); /* Animate with GSAP */
        }
        .info-card h2 {
            font-size: 2.5rem;
            font-weight: 900;
        }
        .info-card p {
            font-size: 1.1rem;
            color: #d1d5db;
            margin-top: 1rem;
        }
    </style>
</head>
<body>

    <canvas id="bg-canvas"></canvas>

    <div class="fixed top-0 left-0 w-full h-full flex flex-col justify-center items-center text-center z-10 pointer-events-none">
        <h1 id="main-title" class="text-5xl md:text-7xl font-black">The Code of Life</h1>
        <p id="scroll-prompt" class="mt-4 text-xl text-gray-300 animate-pulse">Scroll down to explore</p>
    </div>

    <div id="scroll-container">
        <div style="height: 100vh;"></div> <!-- Spacer -->

        <section class="content-section" data-gene="helix">
            <div class="info-card">
                <h2 class="text-blue-400">The Double Helix</h2>
                <p>DNA is structured as a twisted ladder, or "double helix." This elegant shape allows it to store a vast amount of genetic information compactly within a cell's nucleus.</p>
            </div>
        </section>

        <section class="content-section" data-gene="pairs">
            <div class="info-card text-right">
                <h2 class="text-green-400">Base Pairs</h2>
                <p>The "rungs" of the ladder are made of four chemical bases: Adenine (A), Thymine (T), Guanine (G), and Cytosine (C). A always pairs with T, and G always pairs with C, forming the basis of the genetic code.</p>
            </div>
        </section>

        <section class="content-section" data-gene="oca2">
            <div class="info-card">
                <h2 class="text-red-400">The OCA2 Gene</h2>
                <p>This gene provides instructions for making the P protein, found in melanin-producing cells. This protein is crucial for the maturation of melanosomes, which produce and store the pigment melanin. The amount of melanin in the iris determines eye color. Variations in OCA2 result in less P protein, leading to lighter eye colors like blue and green.</p>
            </div>
        </section>

        <section class="content-section" data-gene="ins">
            <div class="info-card text-right">
                <h2 class="text-yellow-400">The INS Gene</h2>
                <p>Located on chromosome 11, the INS gene contains the blueprint for producing insulin. This hormone is essential for metabolizing glucose and regulating blood sugar. The innovation of recombinant DNA technology allowed scientists to insert the human INS gene into bacteria, turning them into tiny factories that produce pure human insulin. This breakthrough has revolutionized diabetes treatment.</p>
            </div>
        </section>
        
        <div style="height: 50vh;"></div> <!-- Spacer -->
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/ScrollTrigger.min.js"></script>
    <script>
        // --- 3D SCENE SETUP ---
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('bg-canvas'), antialias: true, alpha: true });
        const clock = new THREE.Clock();
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x0c0a1a, 1);
        camera.position.z = 15;

        // --- LIGHTING ---
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
        directionalLight.position.set(5, 10, 7.5);
        scene.add(directionalLight);

        // --- BACKGROUND PARTICLES ---
        const particleGeometry = new THREE.BufferGeometry();
        const particleVertices = [];
        for (let i = 0; i < 5000; i++) {
            particleVertices.push(THREE.MathUtils.randFloatSpread(200), THREE.MathUtils.randFloatSpread(200), THREE.MathUtils.randFloatSpread(200));
        }
        particleGeometry.setAttribute('position', new THREE.Float32BufferAttribute(particleVertices, 3));
        const particles = new THREE.Points(particleGeometry, new THREE.PointsMaterial({ color: 0x4a5568, size: 0.1, transparent: true, opacity: 0.5 }));
        scene.add(particles);

        // --- DNA MODEL ---
        const dna = new THREE.Group();
        const basePairs = 100; 
        const helixRadius = 3;
        const rungSpacing = 1.5;
        const basePairObjects = []; 

        const sphereGeo = new THREE.SphereGeometry(0.3, 16, 16);
        const cylinderGeo = new THREE.CylinderGeometry(0.1, 0.1, helixRadius * 2, 8);
        
        const matA = new THREE.MeshPhongMaterial({ color: 0x3b82f6, shininess: 80 }); 
        const matT = new THREE.MeshPhongMaterial({ color: 0x16a34a, shininess: 80 });
        const matG = new THREE.MeshPhongMaterial({ color: 0xef4444, shininess: 80 });
        const matC = new THREE.MeshPhongMaterial({ color: 0xfab005, shininess: 80 });

        for (let i = 0; i < basePairs; i++) {
            const y = (i - basePairs / 2) * rungSpacing;
            const angle = i * 0.5;

            const s1 = new THREE.Mesh(sphereGeo, new THREE.MeshPhongMaterial({color: 0x94a3b8, shininess: 50}));
            s1.position.set(Math.cos(angle) * helixRadius, y, Math.sin(angle) * helixRadius);
            const s2 = s1.clone();
            s2.position.set(-Math.cos(angle) * helixRadius, y, -Math.sin(angle) * helixRadius);
            
            dna.add(s1, s2);

            let mat1, mat2;
            if (Math.random() > 0.5) { mat1 = matA; mat2 = matT; } 
            else { mat1 = matG; mat2 = matC; }

            const base1 = new THREE.Mesh(sphereGeo, mat1);
            base1.position.copy(s1.position).multiplyScalar(0.9);
            const base2 = new THREE.Mesh(sphereGeo, mat2);
            base2.position.copy(s2.position).multiplyScalar(0.9);
            
            const rung = new THREE.Mesh(cylinderGeo, new THREE.MeshPhongMaterial({color: 0x4b5563, shininess: 20}));
            rung.position.y = y;
            rung.lookAt(new THREE.Vector3(1, y, 0));
            rung.rotateX(Math.PI/2);
            rung.rotation.y = -angle;

            const pairGroup = new THREE.Group();
            pairGroup.add(base1, base2, rung);
            basePairObjects.push(pairGroup);
            dna.add(pairGroup);
        }
        scene.add(dna);

        // --- GSAP SCROLL ANIMATION ---
        gsap.registerPlugin(ScrollTrigger);

        gsap.to(["#main-title", "#scroll-prompt"], {
            scrollTrigger: { trigger: "#scroll-container", start: "top 80%", toggleActions: "play none none reverse" },
            opacity: 0, duration: 1
        });

        const mainTimeline = gsap.timeline({
            scrollTrigger: {
                trigger: "#scroll-container",
                scrub: 1.5,
                start: "top top",
                end: "bottom bottom"
            }
        });

        // Enhanced camera path
        mainTimeline.to(dna.position, { y: -basePairs * rungSpacing * 0.8 });
        mainTimeline.to(dna.rotation, { y: Math.PI * 6 }, "<");
        mainTimeline.to(camera.position, { z: 8, x: 2, ease: "power1.inOut" }, "<");
        mainTimeline.to(camera.rotation, { x: -Math.PI / 12, y: Math.PI / 16, ease: "power1.inOut" }, "<");

        // --- DYNAMIC HIGHLIGHTING ---
        const textureLoader = new THREE.TextureLoader();
        const glowTexture = textureLoader.load('https://threejs.org/examples/textures/lensflare/lensflare0.png');

        gsap.utils.toArray('.content-section').forEach(section => {
            const card = section.querySelector('.info-card');
            gsap.fromTo(card, { opacity: 0, y: 50 }, {
                opacity: 1, y: 0, duration: 1,
                scrollTrigger: { 
                    trigger: section, 
                    start: "top center", 
                    toggleActions: "play none none reverse",
                    stagger: 0.2
                }
            });

            const geneType = section.dataset.gene;
            let start, end, colorHex;
            if (geneType === 'oca2') {
                start = 20; end = 35; colorHex = 0xef4444;
            } else if (geneType === 'ins') {
                start = 65; end = 80; colorHex = 0xfab005;
            }

            if (start !== undefined) {
                const glowMaterial = new THREE.SpriteMaterial({ map: glowTexture, color: colorHex, blending: THREE.AdditiveBlending, opacity: 0, transparent: true });
                const glowSprite = new THREE.Sprite(glowMaterial);
                glowSprite.scale.set(30, 30, 1);
                const midPointY = ((start + end) / 2 - basePairs / 2) * rungSpacing;
                glowSprite.position.y = midPointY;
                glowSprite.userData.isGlow = true; // For animation loop
                dna.add(glowSprite);

                const geneMeshes = basePairObjects.slice(start, end).flatMap(group => group.children);
                const geneTimeline = gsap.timeline({
                    scrollTrigger: { trigger: section, start: "top 60%", end: "bottom 40%", scrub: true }
                });

                geneTimeline.to(glowSprite.material, { opacity: 0.5, ease: "power2.in" }, 0);
                geneTimeline.to(glowSprite.material, { opacity: 0, ease: "power2.out" }, ">0.5");
                
                geneMeshes.forEach(mesh => {
                    geneTimeline.to(mesh.material.emissive, { set: colorHex }, 0);
                    geneTimeline.to(mesh.material.emissive, { set: 0x000000 }, ">0.5");
                });
            }
        });
        
        // --- RENDER LOOP ---
        const cursor = { x: 0, y: 0 };
        window.addEventListener('mousemove', (event) => {
            cursor.x = (event.clientX / window.innerWidth - 0.5);
            cursor.y = -(event.clientY / window.innerHeight - 0.5);
        });

        function animate() {
            requestAnimationFrame(animate);
            const elapsedTime = clock.getElapsedTime();

            // Background particle drift
            particles.position.x = Math.sin(elapsedTime * 0.05) * 10;
            particles.position.y = Math.cos(elapsedTime * 0.05) * 10;

            // DNA "breathing" animation
            basePairObjects.forEach((group, i) => {
                const wave = Math.sin(elapsedTime * 1.5 + i * 0.3) * 0.05 + 1;
                group.scale.set(wave, 1, wave);
            });
            
            // Pulsating glow effect
            dna.children.forEach(child => {
                if (child.userData.isGlow && child.material.opacity > 0) {
                    const pulse = Math.sin(elapsedTime * 5) * 0.1 + 0.5;
                    child.material.opacity = pulse;
                }
            });

            // Subtle mouse parallax effect on camera
            const parallaxX = cursor.x * 2;
            const parallaxY = cursor.y * 2;
            camera.position.x += (parallaxX - camera.position.x) * 0.05;
            camera.position.y += (parallaxY - camera.position.y) * 0.05;
            camera.lookAt(dna.position);
            
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
